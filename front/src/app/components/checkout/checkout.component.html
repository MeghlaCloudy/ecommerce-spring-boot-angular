<div class="container-fluid p-0">
  <div class="hero-banner bg-light position-relative overflow-hidden">
    <img src="assets/images/Free Delivery.jpeg" class="w-100" alt="Pond's Niacinamide Routine">

  </div>
</div>

<div class="container py-5" *ngIf="cart">


  <div *ngIf="cart.items.length === 0" class="alert alert-info text-center">
    Your cart is empty.
  </div>

  <div *ngIf="cart.items.length > 0" class="row g-5">
    <!-- Left Side - Billing & Shipping Form -->
    <div class="col-lg-7">
      <div class="card shadow">
        <div class="card-header bg-white text-black">
          <h5 class="mb-0">Billing & Shipping</h5>
        </div>
        <div class="card-body">
          <form #checkoutForm="ngForm">
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Name <span class="text-danger">*</span></label>
                <input type="text" class="form-control" [(ngModel)]="address.name" name="name" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Phone <span class="text-danger">*</span></label>
                <input type="text" class="form-control" [(ngModel)]="address.phone" name="phone" required>
              </div>

              <div class="col-md-6">
                <label class="form-label">Select City <span class="text-danger">*</span></label>
                <select class="form-select" [(ngModel)]="address.city" name="city" required>
                  <option value="">Choose...</option>
                  <option>Dhaka</option>
                  <option>Chittagong</option>
                  <option>Khulna</option>
                  <option>Rajshahi</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label">Select Area <span class="text-danger">*</span></label>
                <select class="form-select" [(ngModel)]="address.area" name="area" required>
                  <option value="">Choose...</option>
                  <option>Mirpur</option>
                  <option>Dhanmondi</option>
                  <option>Gulshan</option>
                  <option>Uttara</option>
                </select>
              </div>

              <div class="col-12">
                <label class="form-label">Address <span class="text-danger">*</span></label>
                <textarea class="form-control" rows="3" [(ngModel)]="address.street" name="street" required></textarea>
              </div>

              <div class="col-md-6">
                <label class="form-label">Email (optional)</label>
                <input type="email" class="form-control" [(ngModel)]="address.email" name="email">
              </div>

              <div class="col-12">
                <label class="form-label">Order Note (optional)</label>
                <textarea class="form-control" rows="2" [(ngModel)]="address.note" name="note"></textarea>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Right Side - Summary + Shipping + Payment -->
    <div class="col-lg-5">
      <div class="card shadow sticky-top" style="top: 20px;">
        <div class="card-body">
          <!-- Coupon -->
          <div class="mb-4">
            <h6 class="text-pink fw-bold">Have Coupon / Voucher?</h6>
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Enter code">
              <button class="btn btn-outline-pink">Apply</button>
            </div>
          </div>

        <!-- Shipping Method -->
        <div class="mb-4">
          <h6 class="fw-bold">Choose Shipping Method</h6>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="shipping" id="outside" [(ngModel)]="shippingMethod"
              value="OUTSIDE_DHAKA">
            <label class="form-check-label" for="outside">
              Delivery Outside Dhaka <span class="text-pink fw-bold">৳100</span>
            </label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="shipping" id="inside" [(ngModel)]="shippingMethod"
              value="INSIDE_DHAKA" checked>
            <label class="form-check-label" for="inside">
              Delivery Inside Dhaka <span class="text-pink fw-bold">৳60</span>
            </label>
          </div>
        </div>
        
        <!-- Total Summary -->
        <div class="border-top pt-3 mb-4">
          <div class="d-flex justify-content-between mb-2">
            <span>Subtotal</span>
            <span>৳{{ cart.totalAmount | number:'1.0-0' }}</span>
          </div>
          <div class="d-flex justify-content-between mb-2">
            <span>Delivery Charge</span>
            <span class="text-pink fw-bold">৳{{ deliveryCharge | number:'1.0-0' }}</span>
          </div>
          <div class="d-flex justify-content-between mb-3">
            <strong class="fs-5">Total Amount</strong>
            <strong class="fs-4 text-pink">৳{{ finalTotal | number:'1.0-0' }}</strong>
          </div>
        </div>

          <!-- Payment Method -->
          <div class="mb-4">
            <h6 class="fw-bold">Choose Payment Method</h6>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="payment" id="cod" [(ngModel)]="paymentMethod"
                value="CASH_ON_DELIVERY" checked>
              <label class="form-check-label" for="cod">
                Cash on delivery
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="payment" id="bkash" [(ngModel)]="paymentMethod" value="BKASH">
              <label class="form-check-label text-pink fw-bold" for="bkash">
                bKash
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="payment" id="card" [(ngModel)]="paymentMethod" value="CARD">
              <label class="form-check-label" for="card">
                Pay with Card/Mobile Wallet
              </label>
            </div>
          
            <!-- bKash Number Field (only show when bKash selected) -->
            <div *ngIf="paymentMethod === 'BKASH'" class="mt-3">
              <label class="form-label">bKash Mobile Number <span class="text-danger">*</span></label>
              <input type="text" class="form-control" [(ngModel)]="bkashNumber" name="bkashNumber" placeholder="01XXXXXXXXX"
                required>
              <small class="text-muted">We will send payment request to this number</small>
            </div>
          </div>

          <!-- Place Order Button -->
          <button class="btn btn-pink w-100 py-3 fw-bold" (click)="placeOrder()" [disabled]="loading">
            <span *ngIf="!loading">Place Order</span>
            <span *ngIf="loading">Processing...</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>